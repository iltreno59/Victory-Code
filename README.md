# Парсер данных с сайта polkrf.ru

## Описание

Этот проект предназначен для массового скачивания медиа и метаданных о ветеранах с сайта [https://polkrf.ru](https://polkrf.ru) с сохранением:
- изображений ветеранов в директорию `images/`
- детальной информации о каждом ветеране в файл `metadata.jsonl` в формате JSON Lines (каждая строка — отдельный ветеран)

Парсер поддерживает запуск как напрямую в Python, так и в виде Docker-контейнера.

## Требования
- Python 3.10+
- pip install:
  - requests
  - beautifulsoup4
  - urllib3

Для Docker: только установленный и запущенный Docker.

## Запуск в Python

```bash
pip install requests beautifulsoup4 urllib3
python parse_polrkrf.py [опции]
```

### Примеры:

- Скачать 1000 записей с 1-й страницы вперёд, с задержкой 1.5 сек:
  ```bash
  python parse_polrkrf.py -n 1000 -s 1 -d 0 -l 1.5
  ```
- Скачать 2000 записей, начиная с 30-й страницы в обратном порядке:
  ```bash
  python parse_polrkrf.py --num-images 2000 --start-page 30 --direction -1 --delay 1
  ```

### Опции командной строки

| Аргумент         | Короткая | Тип    | По умолчанию | Описание                                      |
|------------------|----------|--------|--------------|-----------------------------------------------|
| --num-images     |   -n     | int    |    100       | Сколько всего изображений/ветеранов выгрузить  |
| --start-page     |   -s     | int    |      1       | С какой страницы сайта начинать обработку      |
| --direction      |   -d     | 0,-1   |      0       | 0 — вперёд, -1 — обратно по страницам          |
| --delay          |   -l     | float  |    0.5       | Задержка между всеми сетевыми запросами, сек   |

Порядок аргументов не важен; можно указывать только нужные опции.

### Результат
- Все изображения сохраняются в подпапку `images/`
- Информация по каждому ветерану строчно добавляется в `metadata.jsonl` (UTF-8, JSONL)
- При прерывании или сбое уже собранные строки не теряются

## Работа с Docker

1. Сборка образа (из папки с Dockerfile и parse_polrkrf.py):
   ```bash
   docker build -t polkrf-dataset:1.3 .
   ```
2. Запуск парсера, вывод: 1000 результатов, с задержкой 1с, начиная с 10-й стр., вперёд:
   ```bash
   docker run --rm \
     -v "$PWD/images:/app/images" \
     -v "$PWD/metadata.jsonl:/app/metadata.jsonl" \
     polkrf-dataset:1.3 -n 1000 -s 10 -d 0 -l 1
   ```

- Если нужны другие параметры — добавляйте их по ключам.
- В результате изображения и jsonl окажутся в текущей директории.

### Версионирование Docker-образа
- Каждый раз при существенных изменениях повышайте тег версии (например, `polkrf-dataset:1.4`).
- Для загрузки на Docker Hub:
  1. Войти: `docker login`
  2. Пометить тег: `docker tag polkrf-dataset:1.4 username/polkrf-dataset:1.4`
  3. Залить: `docker push username/polkrf-dataset:1.4`
- Для запуска на другой машине используйте нужный тег версии.

## Советы и рекомендации
- Используйте больший delay (`--delay 1.5` или выше) чтобы не перегружать сервер.
- Для перезапуска после сбоя можно увеличить/уменьшить start_page и пробовать нужное направление.
- Проверяйте достаточно ли свободного места для папки изображений и jsonl-файла.
- Если хотите использовать docker-compose, опишите тома (`volumes`) для images и metadata.jsonl явно.

---
Проект предназначен только для исследовательских и этических целей! Не используйте для создания массивных публичных списков без согласия источника.
